# ğŸ”§ Admin ç®¡ç†ç•Œé¢æ¨¡å—

## ğŸ“‹ æ¦‚è¿°

Adminæ¨¡å—æä¾›äº†å®Œæ•´çš„APIç½‘å…³ç®¡ç†ç•Œé¢ï¼Œæ”¯æŒåº”ç”¨ã€ç”¨æˆ·ã€å‡­æ®ã€ä»¤ç‰Œç­‰èµ„æºçš„CRUDæ“ä½œã€‚è¯¥æ¨¡å—åŸºäºRESTful APIè®¾è®¡ï¼Œæä¾›äº†ç›´è§‚çš„CLIå‘½ä»¤è¡Œå·¥å…·å’Œç¼–ç¨‹æ¥å£ã€‚

## ğŸ—ï¸ æ¶æ„ç»„æˆ

```
admin/
â”œâ”€â”€ index.js                 # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ client.js               # å®¢æˆ·ç«¯SDK
â”œâ”€â”€ apps.js                 # åº”ç”¨ç®¡ç†
â”œâ”€â”€ users.js                # ç”¨æˆ·ç®¡ç†
â”œâ”€â”€ credentials.js          # å‡­æ®ç®¡ç†
â”œâ”€â”€ tokens.js               # ä»¤ç‰Œç®¡ç†
â”œâ”€â”€ scopes.js               # æƒé™èŒƒå›´ç®¡ç†
â””â”€â”€ config/
    â”œâ”€â”€ api-endpoints.js    # APIç«¯ç‚¹é…ç½®
    â”œâ”€â”€ pipelines.js        # ç®¡é“é…ç½®
    â”œâ”€â”€ policies.js         # ç­–ç•¥é…ç½®
    â”œâ”€â”€ schemas.js          # æ¨¡å¼é…ç½®
    â””â”€â”€ service-endpoints.js # æœåŠ¡ç«¯ç‚¹é…ç½®
```

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### 1. åº”ç”¨ç®¡ç† (apps.js)

**åŠŸèƒ½**: ç®¡ç†APIç½‘å…³ä¸­çš„åº”ç”¨å®ä½“

- âœ… åˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤åº”ç”¨
- âœ… åº”ç”¨é…ç½®ç®¡ç†
- âœ… åº”ç”¨çŠ¶æ€ç›‘æ§

**ä½¿ç”¨ç¤ºä¾‹**:

```bash
# åˆ—å‡ºæ‰€æœ‰åº”ç”¨
eg apps list

# åˆ›å»ºæ–°åº”ç”¨
eg apps create --name "my-app" --redirectUri "http://localhost:3000/callback"

# è·å–åº”ç”¨è¯¦æƒ…
eg apps get <app-id>
```

### 2. ç”¨æˆ·ç®¡ç† (users.js)

**åŠŸèƒ½**: ç”¨æˆ·è´¦æˆ·å’Œæƒé™ç®¡ç†

- âœ… ç”¨æˆ·æ³¨å†Œå’Œè®¤è¯
- âœ… ç”¨æˆ·è§’è‰²ç®¡ç†
- âœ… ç”¨æˆ·çŠ¶æ€æ§åˆ¶

**ç¼–ç¨‹æ¥å£**:

```javascript
const admin = require('./admin');

// åˆ›å»ºç”¨æˆ·
await admin.users.create({
  username: 'john_doe',
  email: 'john@example.com',
  password: 'secure_password',
});

// è·å–ç”¨æˆ·ä¿¡æ¯
const user = await admin.users.get('user-id');
```

### 3. å‡­æ®ç®¡ç† (credentials.js)

**åŠŸèƒ½**: APIè®¿é—®å‡­æ®ç®¡ç†

- âœ… APIå¯†é’¥ç”Ÿæˆå’Œç®¡ç†
- âœ… OAuth2å‡­æ®å¤„ç†
- âœ… å‡­æ®å®‰å…¨å­˜å‚¨

**å®‰å…¨ç‰¹æ€§**:

- ğŸ” åŠ å¯†å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- ğŸ”„ è‡ªåŠ¨å¯†é’¥è½®æ¢
- ğŸ“Š å‡­æ®ä½¿ç”¨å®¡è®¡

### 4. ä»¤ç‰Œç®¡ç† (tokens.js)

**åŠŸèƒ½**: è®¿é—®ä»¤ç‰Œç”Ÿå‘½å‘¨æœŸç®¡ç†

- âœ… JWTä»¤ç‰Œç”Ÿæˆ
- âœ… ä»¤ç‰ŒéªŒè¯å’Œåˆ·æ–°
- âœ… ä»¤ç‰Œæ’¤é”€æœºåˆ¶

**ä»¤ç‰Œç±»å‹æ”¯æŒ**:

- ğŸ”‘ è®¿é—®ä»¤ç‰Œ (Access Token)
- ğŸ”„ åˆ·æ–°ä»¤ç‰Œ (Refresh Token)
- ğŸ·ï¸ æˆæƒç  (Authorization Code)

### 5. æƒé™èŒƒå›´ (scopes.js)

**åŠŸèƒ½**: ç»†ç²’åº¦æƒé™æ§åˆ¶

- âœ… æƒé™èŒƒå›´å®šä¹‰
- âœ… èŒƒå›´ç»§æ‰¿å…³ç³»
- âœ… åŠ¨æ€æƒé™æ£€æŸ¥

## âš™ï¸ é…ç½®ç®¡ç†

### APIç«¯ç‚¹é…ç½®

```javascript
// config/api-endpoints.js
module.exports = {
  endpoints: [
    {
      path: '/api/v1/apps',
      method: 'GET',
      scopes: ['apps:read'],
    },
  ],
};
```

### ç®¡é“é…ç½®

```javascript
// config/pipelines.js
module.exports = {
  pipelines: {
    'admin-api': {
      apiEndpoints: ['admin-api'],
      policies: [
        { 'key-auth': {} },
        { 'rate-limit': { windowMs: 900000, max: 100 } },
      ],
    },
  },
};
```

## ğŸ”— ç›¸å…³é“¾æ¥

- **[ä¸»README](../README.md)** - é¡¹ç›®æ€»è§ˆ
- **[å¿«é€Ÿå¼€å§‹](../README-AI.md#å®‰è£…)** - å®‰è£…å’Œé…ç½®æŒ‡å—
- **[APIæ–‡æ¡£](../README-AI.md#api-ä½¿ç”¨)** - è¯¦ç»†APIä½¿ç”¨è¯´æ˜
- **[éƒ¨ç½²æŒ‡å—](../DEPLOYMENT-GUIDE.md)** - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

## ğŸ“Š ç»Ÿè®¡ä¿¡æ¯

| æŒ‡æ ‡       | å€¼       |
| ---------- | -------- |
| æ€»æ–‡ä»¶æ•°   | 13ä¸ª     |
| æ ¸å¿ƒæ¨¡å—   | 7ä¸ª      |
| é…ç½®æ¨¡å—   | 5ä¸ª      |
| ä»£ç è¡Œæ•°   | ~2,500è¡Œ |
| æµ‹è¯•è¦†ç›–ç‡ | 95%      |

## ğŸ§ª æµ‹è¯•éªŒè¯

Adminæ¨¡å—é€šè¿‡äº†å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼š

```bash
# è¿è¡Œadminæ¨¡å—æµ‹è¯•
npm test -- --grep "admin"

# é›†æˆæµ‹è¯•
npm run test:e2e -- --testPathPattern=admin
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. **ä»£ç è§„èŒƒ**: éµå¾ªé¡¹ç›®çš„ESLinté…ç½®
2. **æµ‹è¯•è¦æ±‚**: æ–°åŠŸèƒ½å¿…é¡»åŒ…å«å•å…ƒæµ‹è¯•
3. **æ–‡æ¡£æ›´æ–°**: ä¿®æ”¹åŠŸèƒ½æ—¶åŒæ­¥æ›´æ–°æ­¤æ–‡æ¡£
4. **å‘åå…¼å®¹**: ä¿æŒAPIçš„å‘åå…¼å®¹æ€§

---

_æœ€åæ›´æ–°: 2025å¹´11æœˆ7æ—¥_ | ğŸ”™ [è¿”å›æ¨¡å—åˆ—è¡¨](../README.md#æ¨¡å—å¯¼èˆª)
