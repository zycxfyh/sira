http:
  port: ${EG_HTTP_PORT:-8080}
  hostname: localhost
apiEndpoints:
  ai-api:
    host: localhost
    paths: ['/api/v1/ai/*']
  health-api:
    host: localhost
    paths: ['/health']
  admin-api:
    host: localhost
    paths: ['/admin/*']

serviceEndpoints:
  ai-router:
    url: 'http://localhost:3000' # Placeholder, will be overridden by AI router policy
  health-service:
    url: 'http://localhost:9876' # Health service endpoint
  admin-service:
    url: 'http://localhost:9876'

policies:
  - ai-router
  - ai-cache
  - cors
  - expression
  - headers
  - jwt
  - key-auth
  - log
  - oauth2
  - oauth2-introspect
  - proxy
  - rate-limit
  - request-transformer
  - response-transformer

pipelines:
  health-pipeline:
    apiEndpoints:
      - health-api
    policies:
      - request-transformer:
          rewrite: '/health'  # Rewrite /health to match admin service
      - proxy:
          serviceEndpoint: health-service

  ai-pipeline:
    apiEndpoints:
      - ai-api
    policies:
      - cors: {}
      - key-auth:
          apiKeyHeader: 'x-api-key'
      - ai-cache:
          ttl: 300
          maxSize: 1000
      - ai-router:
          timeout: 30000
          cacheEnabled: true
      - proxy: {}

  # admin-pipeline:
  #   apiEndpoints:
  #     - admin-api
  #   policies:
  #     - jwt: {}
  #     - rate-limit:
  #         windowMs: 900000
  #         max: 100
  #     - proxy:
  #         serviceEndpoint: admin-service

admin:
  port: 9877
  host: localhost
